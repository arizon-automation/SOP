# 功能使用指南 / Features Guide

## 🎉 新功能 / New Features

### 1. ✏️ SOP编辑功能 / SOP Editing

#### 功能特性
- **完整的编辑能力**：修改标题、描述、部门、分类
- **步骤管理**：添加、删除、重新排序、编辑步骤
- **自动翻译**：编辑中文版会自动更新英文版（反之亦然）
- **版本控制**：每次保存自动增加版本号（如 1.0 → 1.1）
- **实时预览**：边编辑边查看效果

#### 使用方法
1. 进入任意SOP详情页
2. 点击右侧的 "✏️ 编辑SOP" 按钮
3. 修改任何需要的内容
4. 添加/删除/调整步骤顺序
5. 点击 "💾 保存更改"
6. 自动更新中英文双语版本

#### 访问路径
- 编辑页面：`/sops/[id]/edit`
- API端点：`PATCH /api/sops/[id]`

#### 技术实现
- 使用React hooks管理表单状态
- 拖拽式步骤排序
- AI自动翻译对应语言版本
- 事务性数据库更新确保一致性

---

### 2. 💬 AI智能问答 / AI Q&A Chatbot

#### 功能特性
- **智能搜索**：从所有SOP中搜索相关内容
- **自然对话**：使用GPT-4生成自然、准确的回答
- **相关SOP推荐**：显示与问题最相关的SOP列表
- **聊天历史**：记录所有问答对话
- **双语支持**：中英文自动切换
- **示例问题**：提供常见问题快速开始

#### 使用方法
1. 从Dashboard点击 "AI智能问答"
2. 输入你的问题，例如：
   - "如何处理客户退货？"
   - "仓库盘点的步骤是什么？"
   - "销售订单审批流程？"
3. AI会搜索相关SOP并生成答案
4. 点击推荐的SOP可以查看完整内容

#### 访问路径
- 聊天页面：`/qa`
- API端点：`POST /api/qa/ask`

#### 技术实现
- 文本搜索匹配相关SOP内容
- OpenAI GPT-4o-mini生成答案
- 相似度排序推荐相关SOP
- 问答历史记录到数据库
- 实时聊天界面

---

## 📋 现有功能总览 / Existing Features

### 文档管理 / Document Management
- ✅ 上传PDF、Word文档
- ✅ 自动提取文本内容
- ✅ 提取并保存图片
- ✅ 文档列表和详情查看
- ✅ 删除文档

### SOP管理 / SOP Management
- ✅ AI自动生成SOP结构
- ✅ 中英文双语自动翻译
- ✅ 图片嵌入到对应步骤
- ✅ 冲突检测和智能合并
- ✅ **编辑SOP** (NEW!)
- ✅ 删除SOP
- ✅ 版本控制

### 语言功能 / Language Features
- ✅ 中英文一键切换
- ✅ 自动过滤当前语言的SOP
- ✅ 智能跳转到对应语言版本
- ✅ 全界面双语支持

### AI功能 / AI Features
- ✅ 文档智能解析
- ✅ 结构化提取步骤
- ✅ 自动翻译
- ✅ 冲突检测
- ✅ 智能合并建议
- ✅ **AI问答聊天机器人** (NEW!)

---

## 🚀 快速开始 / Quick Start

### 编辑现有SOP
```
1. 访问 http://localhost:3000/sops
2. 点击任一SOP卡片
3. 点击 "✏️ 编辑SOP"
4. 修改内容
5. 保存
```

### 使用AI问答
```
1. 访问 http://localhost:3000/qa
2. 输入问题
3. 查看AI回答和相关SOP
4. 点击SOP链接查看详情
```

---

## 📊 数据统计 / Analytics

系统自动记录以下数据：
- ❓ 用户提问频率和内容
- 📈 SOP访问统计
- 🔍 搜索关键词分析
- ⏰ 使用时间分布

---

## 🎨 界面预览 / UI Preview

### SOP编辑页面
- 清晰的表单布局
- 拖拽式步骤管理
- 实时保存状态
- 取消/保存按钮

### AI问答界面
- 聊天气泡式对话
- 清晰的用户/AI区分
- 相关SOP卡片展示
- 示例问题快速开始

---

## 🔐 权限说明 / Permissions

目前所有登录用户都可以：
- ✅ 查看所有SOP
- ✅ 编辑任何SOP
- ✅ 使用AI问答
- ✅ 上传和管理文档

---

## 💡 使用技巧 / Tips

### SOP编辑
- 使用 ⬆️⬇️ 按钮快速调整步骤顺序
- 编辑中文版会自动同步到英文版
- 每次保存都会增加版本号

### AI问答
- 尽量使用完整的问题句子
- 可以问具体的流程、负责人、条件等
- 切换语言后可以用对应语言提问
- 点击示例问题快速开始

---

## 🐛 已知问题 / Known Issues

1. ⚠️ 向量搜索尚未完全实现（目前使用文本搜索）
2. ⚠️ PDF导出功能开发中
3. ⚠️ 批量编辑功能待开发

---

## 🔄 下一步计划 / Next Steps

- [ ] 实现真正的向量搜索（pgvector）
- [ ] SOP分类树展示
- [ ] AI监督者集成
- [ ] 批准工作流
- [ ] PDF导出功能
- [ ] 高级搜索过滤
- [ ] 用户权限管理

---

## 📞 技术支持 / Support

如有问题，请查看：
- `LOCAL_DEV_GUIDE.md` - 本地开发指南
- `LANGUAGE_SWITCHER_GUIDE.md` - 语言切换指南
- `IMAGE_EXTRACTION_FIX.md` - 图片提取说明

---

**更新时间**: 2025-01-05
**版本**: 1.0.0

